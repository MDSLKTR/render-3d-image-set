var build,i,fetchProducts,jsonUrl="assets/data/set.json",loader,start,end,imgWrapper=React.createClass({displayName:"renderImage",getInitialState:function(){return{activeImage:"assets/icons/white.gif",activeAngle:0,loading:!0}},getJson:function(a){start=(new Date).getTime(),$.ajax({product:a,url:jsonUrl,dataType:"json",success:function(b){this.setState({imageData:b.products[a],activeImage:b.products[a][0].src,activeAngle:b.products[a][0].angle,loading:!1}),console.log("product images fetched!"),clearInterval(fetchProducts),end=(new Date).getTime(),console.log("product image list fetched in",end-start,"ms")}.bind(this),error:function(a,b,c){console.error(jsonUrl,b,c.toString())}.bind(this)})},componentDidMount:function(){this.hammer=new Hammer(React.findDOMNode(this.refs.hammerHook)),this.hammer.get("pan").set({threshold:0,direction:Hammer.DIRECTION_ALL}),this.hammer.on("panup",this.panUp),this.hammer.on("pandown",this.panDown),fetchProducts=setInterval(this.getJson("id-12345"),500)},componentWillUnmount:function(){this.hammer.off("panup",this.panUp),this.hammer.off("pandown",this.panDown)},mapImages:function(a){for(i=0;i<this.state.imageData.length;i++)a===this.state.imageData[i].angle&&this.setState({activeImage:this.state.imageData[i].src})},panDown:function(a){console.log("Distance traveled: "+a.distance),console.log("X-pos: "+a.deltaX),console.log("Velocity: "+a.velocityX),this.state.activeAngle>0?(this.setState({activeAngle:this.state.activeAngle-30}),this.mapImages(this.state.activeAngle)):(this.setState({activeAngle:330}),this.mapImages(330))},panUp:function(a){console.log("Distance traveled: "+a.distance),console.log("X-pos: "+a.deltaX),console.log("Velocity: "+a.velocityX),this.state.activeAngle<330?(this.setState({activeAngle:this.state.activeAngle+30}),this.mapImages(this.state.activeAngle)):(this.setState({activeAngle:0}),this.mapImages(0))},incrementAngle:function(){this.state.activeAngle<330?(this.setState({activeAngle:this.state.activeAngle+30}),this.mapImages(this.state.activeAngle+30)):(this.setState({activeAngle:0}),this.mapImages(0))},decrementAngle:function(){this.state.activeAngle>0?(this.setState({activeAngle:this.state.activeAngle-30}),this.mapImages(this.state.activeAngle-30)):(this.setState({activeAngle:330}),this.mapImages(330))},render:function(){return loader=[],build=[],this.state.loading===!0&&(loader.push(React.DOM.img({className:"loader",key:"loader-img",alt:"loader",src:"/assets/icons/ajax-loader.svg"})),loader.push(React.DOM.span({className:"loader-text",key:"loader-text"},"Loading Product View..."))),this.state.imageData&&this.state.imageData.forEach(function(a){build.push(React.DOM.img({key:"angle-"+a.angle,alt:"product-view-"+a.angle,src:a.src,"data-angle":a.angle}))}),React.DOM.div({className:"image-container"},loader,React.DOM.div({className:"image-set"},build),React.DOM.div({ref:"hammerHook",className:"image-active"},React.DOM.img({src:this.state.activeImage,alt:"product-view-"+this.state.activeAngle,"data-angle":this.state.activeAngle})),React.DOM.span({className:"intro"},"Click(Touch) and Drag or click the buttons to rotate"),React.DOM.button({onClick:this.incrementAngle,className:"button-right"},"R"),React.DOM.button({onClick:this.decrementAngle,className:"button-left"},"L"))}});React.render(React.createElement(imgWrapper),document.getElementById("main"));